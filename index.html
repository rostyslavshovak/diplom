<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Real-time Chat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.1.3/dist/purify.min.js"></script>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
      
      body {
        font-family: 'Inter', sans-serif;
      }
      
      .chat-container {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }
      
      .message-bubble {
        max-width: 80%;
        word-wrap: break-word;
        animation: slideUp 0.3s ease-out;
      }
      
      .message-sent {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      }
      
      .message-received {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      }
      
      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      
      .connection-indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        animation: pulse 2s infinite;
      }
      
      .connected {
        background-color: #10b981;
      }
      
      .disconnected {
        background-color: #ef4444;
      }
      
      .connecting {
        background-color: #f59e0b;
      }
      
      @keyframes pulse {
        0%, 100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }
      
      .typing-indicator {
        display: flex;
        align-items: center;
        gap: 4px;
      }
      
      .typing-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background-color: #6b7280;
        animation: typing 1.4s infinite;
      }
      
      .typing-dot:nth-child(2) {
        animation-delay: 0.2s;
      }
      
      .typing-dot:nth-child(3) {
        animation-delay: 0.4s;
      }
      
      @keyframes typing {
        0%, 60%, 100% {
          transform: translateY(0);
        }
        30% {
          transform: translateY(-10px);
        }
      }
    </style>
  </head>
  <body class="min-h-screen bg-gradient-to-br from-purple-400 via-pink-500 to-red-500">
    <div class="mx-auto px-4 py-6 max-w-7xl w-full">
      <!-- Chat Header -->
      <div class="chat-container rounded-t-2xl px-6 py-4 border-b border-gray-200">
        <div class="flex items-center justify-between">
          <div class="flex items-center space-x-3">
            <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center">
              <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
              </svg>
            </div>
            <div>
              <h1 class="text-xl font-semibold text-gray-800">Real-time Chat</h1>
              <p class="text-sm text-gray-500" id="connectionStatus">Connecting...</p>
            </div>
          </div>
          <div class="flex items-center space-x-2">
            <div class="connection-indicator connecting" id="connectionIndicator"></div>
            <span class="text-sm text-gray-600" id="userCount">1 user</span>
          </div>
        </div>
      </div>

      <!-- Messages Container -->
      <div class="chat-container h-96 overflow-y-auto p-6 space-y-4" id="messagesContainer">
        <div class="text-center text-gray-500 text-sm">
          <p>Welcome to the chat! Start a conversation...</p>
        </div>
      </div>

      <!-- Typing Indicator -->
      <div class="chat-container px-6 py-2 border-t border-gray-200" id="typingContainer" style="display: none;">
        <div class="flex items-center space-x-2">
          <div class="typing-indicator">
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
            <div class="typing-dot"></div>
          </div>
          <span class="text-sm text-gray-500">Someone is typing...</span>
        </div>
      </div>

      <!-- Message Input -->
      <div class="chat-container rounded-b-2xl px-6 py-4 border-t border-gray-200">
        <div class="flex items-center space-x-3">
          <div class="flex-1 relative">
            <input
              type="text"
              id="messageInput"
              placeholder="Type your message..."
              class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
              maxlength="500"
            />
            <div class="absolute right-3 top-1/2 transform -translate-y-1/2 text-xs text-gray-400" id="charCount">
              0/500
            </div>
          </div>
          <button
            id="sendButton"
            class="px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl hover:from-blue-600 hover:to-purple-700 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
            </svg>
            <span>Send</span>
          </button>
        </div>
        <div class="mt-2 text-xs text-gray-500">
          Press Enter to send â€¢ Shift+Enter for new line
        </div>
      </div>
    </div>

    <!-- Loading/Error Modal -->
    <div id="statusModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" style="display: none;">
      <div class="bg-white rounded-2xl p-6 max-w-sm mx-4 text-center">
        <div id="modalContent">
          <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"></div>
          <p class="text-gray-700">Connecting to chat...</p>
        </div>
      </div>
    </div>

    <script type="module" src="chat.js"></script>
  </body>
</html>